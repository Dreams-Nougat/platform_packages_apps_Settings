Revision: 762068ee946ee5bc7d4e3ebca6e0171f12aba665
Patch-set: 1
File: src/com/android/settings/DataUsageSummary.java

2269
Tue Mar 19 16:45:05 2013 +0000
Author: Jeff Sharkey <1006166@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: R-WVapv8
Bytes: 258
i'd rather fix this by moving the mStatsService.openSession() code into onCreate() before this method is invoked.  (that way the we always have a mStatsSession in this method.)

it also better matches the lifecycle, since we close the session in onDestroy().

2269
Tue Mar 19 17:13:34 2013 +0000
Author: Jaewan Kim <1019013@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: R-WVapv8
UUID: R-UW5KtU
Bytes: 688
Thank you for your review. I forgot to check destroy logic. In that case, I prefer to move closing session to onDestroyView because simply opening session at onCreate would make another issue.

If ethernet is really present and there was no data usage so far, mShowEthernet would be set to false at the onCreate. However, if a user connect ethernet afterwards and resume this view, user would experience the same issue because mShowEthernet variable is checked along with hasEthernet() to determine whether to show ethernet related UIs (context menu and tab).

How do you think? Best way to fix this issue would be creating hardware feature for ethernet and check it instead but we don't.

2269
Tue Mar 19 17:31:00 2013 +0000
Author: Jeff Sharkey <1006166@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: R-UW5KtU
UUID: R-eV3dkw
Bytes: 479
thinking about this a bit more, could we just have that "override preferences when no mobile radio" if() block in onCreate() set both mShowWifi and mShowEthernet to true?  as you pointed out, we always check against hasEthernet() later before actually showing any UI.

that should handle the resume-after-traffic case you pointed out.

btw it shouldn't be a hardware feature, since network connections can come/go.  for example, consider a USB ethernet adapter that is transient.

2269
Wed Mar 20 02:23:42 2013 +0000
Author: Jaewan Kim <1019013@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: R-eV3dkw
UUID: SFqwhQ68
Bytes: 59
that sounds more reasonable. thank you for detailed review.

